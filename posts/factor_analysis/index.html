<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">




<title>Factor Analysis | As it is</title>

<link rel="stylesheet" href="https://jgerardsimcock.github.io//css/styles.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" 
integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/zenburn.min.css" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="https://jgerardsimcock.github.io//js/highlight.js"></script>






<div class="container">
    <nav class="navbar level">
      <div class="navbar-brand">
          <a class="nav-item" href="https://jgerardsimcock.github.io/"><h1 class="title is-3">As it is</h1></a>
      </div>           
      <div class="navbar-menu has-text-centered is-active">
          <div class="navbar-end is-centered">
              
                <a href="https://github.com/jgerardsimcock">
                  <span class="icon">
                    <i class="fab fa-github"></i>
                  </span>
                </a>
              
                <a href="https://www.linkedin.com/in/jgerardsimcock">
                  <span class="icon">
                    <i class="fab fa-linkedin-in"></i>
                  </span>
                </a>
              
                <a href="https://twitter.com/jgerardsimcock">
                  <span class="icon">
                    <i class="fab fa-twitter"></i>
                  </span>
                </a>
              
                <a href="https://www.instagram.com/_justin_gerard/">
                  <span class="icon">
                    <i class="fab fa-instagram"></i>
                  </span>
                </a>
              
                <a href="https://www.goodreads.com/user/show/14378346-justin-simcock">
                  <span class="icon">
                    <i class="fab fa-goodreads"></i>
                  </span>
                </a>
              
           </div>
      </div>
    </nav>
  </div>
<div class="container">
  <h2 class="subtitle is-6">January 8, 2019</h2>
  <h1 class="subtitle is-size-4-mobile is-size-3-desktop">Factor Analysis</h1>
  <div class="content">
    

<p>I&rsquo;ve just completed Term 1 of Udacity&rsquo;s AI for Trading Nanodegree program. This is not a review of the course content. This is a review for my own benefit of the some concepts that I need to work with and better understand. My verbal characterization of my understanding of these concepts will be crude, imprecise and potentially wrong. This is a work in progress.</p>

<h2 id="factor-models">Factor Models</h2>

<p>The origin of Factor Model is the French/Fama three-factor model. In this model they used &lsquo;factors&rsquo; like market-capitalization and growth.</p>

<p>Factor models having explanatory value for risk/returns. For each factor and asset in a factor model, there is a Beta coefficient that indicates the sensitivity of a particular asset to a given factor. Factor models also include the security specific alpha and security specific noise/error or other behavior not capture by factor.</p>

<p>The &lsquo;traditional&rsquo; approach to factor models is to use &lsquo;observable&rsquo; factors. However, with methods like PCA and deep learning, there are factors that are latent or unobservable, at least to humans.</p>

<p>Factor models using observable factors. PCA seeks to identify, latent non-observable factors. PCA as dimenstionality reduction. PCA for highly correlated data.</p>

<h2 id="factors">Factors</h2>

<p>My current understanding of a factor is something to contributes to return behavior for some defined period. For example, if the price of an asset has gone up/down quickly over a period we can say that momentum is a factor that contributes some percentage to overall returns. Another example would be the market cap of company. We could say that the size of a company, its market cap, contributes some amount to the overall return.</p>

<p>There are several types of &lsquo;observable&rsquo; factors that can be considered.</p>

<ul>
<li>Value: i.e price to book, price to earnings, dividends, and free cash flow</li>
<li>Size: i.e large cap vs small cap</li>
<li>Momentum: returns from the recent past will continue for some period forward</li>
<li>Quality: low debt, stable earnings, consistent asset growth, and strong corporate governance, return to equity,
debt to equity and earnings variability</li>
<li>Volatility: i.e. standard deviation of returns over some period</li>
</ul>

<p>These methods can be reasoned about by humans. With a sufficient amount of time and education, they make sense to us. With PCA and deep learning the latent factors are not obvious or meaningful to humans.</p>

<h2 id="time-series-and-cross-sectional-models">Time Series and Cross Sectional Models</h2>

<p>Cross-sectional models allow you to perform analysis on assets in a similar industry, country or other grouping at a given point in time. Time series models allow you to perform analysis on heterogenous types of assets through time.</p>

<h2 id="pca">PCA</h2>

<p>Principal Component Analysis is a way to take a matrix and decompose it a new set of matrices. In linear algebra, we used eigenvectors as as a way to find a new basis for the system that maximized the variance among the points. With PCA we are finding the basis that maximizes the variance.</p>

<h2 id="risk-factor-models-using-pca">Risk Factor Models using PCA</h2>

<p>PCA is used in risk modeling so that we can identify the principal components with the greatest variance. We also decompose our returns matrix into factor_exposure and factor_returns matrices. This allows us to identify latent source of alpha and risk. We can then model each of these latent variables return profiles to see how a given assets exposure to the factor affects its return for some period.</p>

<p>We can reallocate our weights to separate assets based on potential risk/return profiles for a given factor/asset pair. And we can update this as we move through time so if we estimate that the risk of a given factor has increased and one of our main positions has a high exposure for that factor, we can reduce or exit our position. Similarly if the returns of a given factor are going up we should increase our position for a given asset.</p>

<h2 id="risk-neutralization">Risk Neutralization</h2>

<h5 id="market-risk">Market Risk</h5>

<p>By definition, our market risk is zero since the sum of our alpha vector is zero for any given time period. We can accomplish this by subtracting the mean of the alpha vector from each alpha in the alpha vector. The assumption is that each stocks exposure to the market is 1.0 or completely exposed and positively correlated.</p>

<h5 id="sector-risk">Sector Risk</h5>

<p>We also want to be sector neutral so we perform a similar neutralization as the market neutralization. We subtract sector mean from each of the alpha weights in the sector. This will give us a zero net exposure to a given sector. The assumption is that each stocks exposure to the sector is 1.0 or completely exposed and positively correlated.</p>

<p>A portfolio will first be neutralized by market then by each sector to which it is exposed.</p>

<h1 id="alpha-factors">Alpha Factors</h1>

<p>Alpha Factors are things that contribute to alpha. Many are a function of price and volume. Some can come from alternative data. Some can come from fundamanetal data produced by the company. In this way, it is a bit of a blend of the traditional technical vs fundamental. Its power is amplified with the use of machine learning and large-scale computing to identify signal in large data sets.</p>

<p>In our final project we worked with a number of alpha factors like 5 day price mean reversion, 1 year momentum, overnight sentiment.</p>

<p>Alpha Factors also refer to the time series of alpha vectors of multiple time periods.</p>

<p>Raw Alpha Factors are unprocessed and unoptimized time series of signals.</p>

<p>We process our Alpha Factors with the following techniques:</p>

<ul>
<li>Market neutralization</li>
<li>Sector neutralization</li>
<li>Ranking</li>
<li>z-scoring</li>
<li>Smoothing</li>
</ul>

<p>If your alpha vectors are generated from different stock universes, ranking then z-scoring will preserve robustness to outliers and noise.</p>

<h1 id="alpha-vectors">Alpha Vectors</h1>

<p>vector/array of positive and negative numbers that indicate the the long/short signal for a given asset for a given period of time. If positive long, if negative short. Each number in the vector is proportional to the amount of capital to be allocated to each asset for each time period. This vector is standardized with mean of 0 and the sum of its absolute values is equal to one. This is because 100% of our allocation is represented in the vector.</p>

<h1 id="researching-alpha-factors">Researching Alpha Factors</h1>

<p>Examples of research papers and the process of turning papers into alpha factors</p>

<p>How Risk models and Alpha models interact</p>

<h1 id="evaluating-alpha-factors">Evaluating Alpha Factors</h1>

<h4 id="factor-returns">Factor Returns</h4>

<p>We construct a theoretical portfolio with the alpha vector for a given time period and compute the returns
for each successive time step. Standardize the alpha vector and compute single day returns from the weight of each alpha in the alpha vector times the retrun for the asset.</p>

<h4 id="quantiles">Quantiles</h4>

<p>We took the quantiles of our daily factor returns to see how we would possibly implement a strategy using the factor. Low negative daily returns would be opportunities to short and high positive daily returns would be opportunities to go long. We want our daily returns to be monotonic in there quantiles. The highest alpha values should have the highest returns and the lowest alpha values should have the lowest returns. And the relationship should increase monotonically. For our project, many of the alpha&rsquo;s generated signal on the short side. This is sub-optimal since you need to find the stock to short and it can be expensive to short. Finally, the daily average return for many of the alphas was around 3 basis points. That&rsquo;s pretty small. Annualized that is roughly 7.5%. If you include transaction costs that can further reduce your return. The point is, that many of these strategies only make sense under leverage and because of this are only suitable for institutional investors.</p>

<h4 id="turnover-analysis-factor-rank-autocorrelation">Turnover Analysis: Factor Rank Autocorrelation</h4>

<p>To understand the stability of the alpha factors, we can do a test to see how frequently our alphas shift in their respective rank vis-a-vis other assets in our alpha vector. This will also help us understand potential trading costs for system built upon a set of alphas.</p>

<h4 id="sharpe-ratio-of-alphas">Sharpe Ratio of Alphas</h4>

<p>Sharpe ratio is a measurement of how much volatility you should expect for a given expected return. Many investors are uncomfortable with high volatility. Values of 1 and higher are good targets for a sharpe ratio. We smoothed our factors to remove some of the volatility. These volatility reducing transformations did not seem to affect Sharpe Ratio that much.</p>

<h4 id="rank-information-coefficient">Rank Information Coefficient</h4>

<p>Do our ranks in our alpha vector correspond to future returns? If so then we have high information coefficient. If not then we have a low information coefficient. We repeat this over a multiple time periods, this will give us a time series of Rank IC correlations.</p>

<p>Correlation of ranked values is called Spearman correlation value.</p>

<h4 id="transfer-coefficient">Transfer Coefficient</h4>

<p>How does your factor perform before and after risk neutralization and optimization. Does it preserve its long/short state or does it flip? The Transfer coefficient will also indicate independence from risk factors. That is if the risk neutralization has not affected the factor rank then it is unaffected by the risk neutralization.</p>

<h4 id="alpha-performance-code">Alpha Performance Code</h4>

<p>Since much of this relies heavily on <a href="https://www.quantopian.com/">Quantopian&rsquo;s</a> open source code here is the link to their <a href="https://github.com/quantopian/alphalens/blob/master/alphalens/performance.py">alphalens performance code</a></p>

<h2 id="combining-alpha-factors">Combining Alpha Factors</h2>

<p>We have a bunch of alpha vectors corresponding to different alphas and each of these vectors has a unique coefficient associated with each asset. So how to use them? You combine them somehow to get a composite alpha vector and this will tell you what to do on a give day for a given asset. In our project, we just took the average among the alphas and created our combined alpha vector.</p>

<h4 id="conditional-factors">Conditional Factors</h4>

<ul>
<li>Quantiles of quantiles</li>
<li>Multiply factors together</li>
<li>Momentum and Volume</li>
<li>Machine learning&hellip;</li>
</ul>

<h1 id="constraints">Constraints</h1>

<h4 id="liquidity">Liquidity</h4>

<p>Some assets do not trade as frequently or with as much volume as others. This increases the bid-ask spread. Iliquid assets with high bid-ask spread may be difficult to short. There are a few reasons. There may not be enough shares available to short. And the bid-ask spread may be so large as to eliminate the benefit of the short. Alternatively, assets with low bid-ask spreads will be easier to short.</p>

<h4 id="market-impact">Market Impact</h4>

<p>The act of buying and selling assets affects the supply and demand of a given asset. This will affect the price. So simply by executing your strategy you may be moving price to a place where you do not want to trade.</p>

<h2 id="portfolio-optimization">Portfolio Optimization</h2>

<p>We have constructed an alpha model and a risk model. So we want to construct a portfolio that tracks as close as possible to the objectives of these two models.</p>

<p>It is certain that we will face constraints on portfolio construction. At the least, if we are market neutral, we need to make sure the sum our weights is zero. There will also be risk constraints and factor exposure constraints for each asset.</p>

<h4 id="objective-and-constraint-functions">Objective and Constraint functions</h4>

<p>Our overall objective is to maximize alpha while minimizing risk. Our alpha model focuses on maximizing alpha and our risk focuses on minimizing risk. I know sounds easy. We want a quantity in the objective function that represents the portfolio return. This is our alpha vector multiplied by our weights. We want a quantity in our constraints that limits risk below some threshold. We can take the portfolio variance that we compute in our PCA risk model. We want to set this below a risk tolerance. The risk tolerance is set to the amount of drawdown/variance that an asset manager is willing to take on any given time period.</p>

<p>We use a library called cvxpy to optimize our portfolio. This libray allows you to define and minimize/maximize and objective function. It also takes a set of constraints under which to optimize. The outcome of this is that it allows us to know which stocks to put positions in. It defines a vector of weights for the portfolio for each stock.</p>

<h4 id="constraining-risks">Constraining risks</h4>

<p>We perform regularization constraints to increase the diversification of the portfolio. We use the L2 norm to minimize the weights on any given asset. The L2 norm is the length of our vector. If any vector is large, it will magnify the total length of the vector. L2 regularization penalizes concentrationn and enforces diversification. We update our objective function by adding a regularization term. The affect of this is to increase the weights for some factors and decrease the weights for other factors resulting in a more diversified set of holdings.</p>

<p>If you imagine two states of belief, one a strong belief in the sign and magnitude of change and another simply in the sign of change than L2 regularization allows shift how much we believe one state vs the other. We do this by selecting a smaller or larger lambda.</p>

<p>We perform a final bootstrap like optimization by trying to minimize the distance between our portfolio weights and the weights of an ideal index. Since we are not given a set of ideal index weights we perform a bootstrap by creating a weighting scheme that is proportional to the future returns for each asset.</p>

<p>Additional constraints such as market neutrality, turnover constraints, leverage constraints as well as factor exposures may also apply. The factor exposure constraint is interesting. It&rsquo;s like we don&rsquo;t want to put to much behind any one of the sources of our beliefs.</p>

<h4 id="additional-considerations">Additional Considerations</h4>

<p>Final consideration is to see how much the optimization has changed our alpha vector. If it changes the ranks meaningfully then we should consider that our alpha will need to be more thoroughly researched. The reason we do the risk neutralization before the optimization is that it allows us to minimize the sources of error. If we had waited to minimize risk during the optimization and our optimized alpha vector was very different from the original than we really would not be able to attribute the source of the error.</p>

<p>This part of the process seems to be where the art of the process comes in. It depends on your mandate and it depends on your abilities regarding on what next step you&rsquo;ll take. You could do an infinite number of optimizations to meet the specific requirements of your mandate.</p>

<h1 id="disclosure">DISCLOSURE</h1>

<p>The above references an opinion and is for information purposes only.  It is not intended to be investment advice.  Seek a duly licensed professional for investment advice.</p>

  </div>
</div>
<div class="container has-text-centered">
    
</div>

<div class="container has-text-centered">
  
</div>
<section class="section">
  <div class="container has-text-centered">
    <p>&copy; <a href="https://github.com/jgerardsimcock">Simcock</a> 2018</p>
  </div>
</section>


